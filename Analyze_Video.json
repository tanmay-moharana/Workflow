{
  "name": "YouTube Gaming Highlights to Shorts with Progress Logging",
  "nodes": [
    {
      "id": "1",
      "name": "Trigger Every 6h",
      "type": "n8n-nodes-base.cron",
      "parameters": {
        "triggerTimes": [{ "mode": "everyX", "unit": "hours", "value": 6 }]
      },
      "typeVersion": 1,
      "position": [200, 200]
    },
    {
      "id": "2",
      "name": "Get Channel Uploads",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "url": "https://www.googleapis.com/youtube/v3/search",
        "authentication": "oAuth2",
        "queryParametersUi": {
          "parameter": [
            { "name": "part", "value": "snippet" },
            { "name": "channelId", "value": "UCqKZx0XQEFg6OD79XEfiERg" },
            { "name": "order", "value": "date" },
            { "name": "maxResults", "value": "1" },
            { "name": "type", "value": "video" }
          ]
        }
      },
      "typeVersion": 2,
      "position": [400, 200],
      "credentials": { "oAuth2Api": "YouTube OAuth2" }
    },
    {
      "id": "2a",
      "name": "Build Video URL",
      "type": "n8n-nodes-base.function",
      "parameters": {
        "functionCode": "if (!$json.id?.videoId) throw new Error('videoId not found');\nreturn [{ json: { videoUrl: `https://www.youtube.com/watch?v=${$json.id.videoId}` } }];"
      },
      "typeVersion": 1,
      "position": [600, 200]
    },
    {
      "id": "2b",
      "name": "Download Video & Write Progress",
      "type": "n8n-nodes-base.executeCommand",
      "parameters": {
        "command": "bash",
        "arguments": [
          "-c",
          "mkdir -p /data && yt-dlp --cookies /data/youtube-cookies.txt -f bestvideo+bestaudio/best --merge-output-format mp4 --compat-options no-youtube-legacy-dash -o /data/video.%(ext)s {{$json[\"videoUrl\"]}} --progress-template '%(progress)s%%' | while read line; do echo \"$(date +'%H:%M:%S') $line\" >> /tmp/yt_progress.log; done &"
        ]
      },
      "typeVersion": 1,
      "position": [800, 200]
    },
    {
      "id": "3",
      "name": "Read Download Progress",
      "type": "n8n-nodes-base.readBinaryFile",
      "parameters": { "filePath": "/tmp/yt_progress.log" },
      "typeVersion": 1,
      "position": [1000, 200]
    },
    {
      "id": "4",
      "name": "Log Progress to Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "parameters": {
        "operation": "append",
        "sheetId": "<YOUR_SHEET_ID>",
        "range": "Progress!A:B",
        "fields": { "values": ["={{$json[\"fileName\"]}}", "={{$json[\"data\"]}}"] }
      },
      "typeVersion": 2,
      "position": [1200, 200],
      "credentials": { "googleApi": "Google Sheets OAuth2" }
    },
    {
      "id": "5",
      "name": "Analyze Video with Gemini",
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "parameters": {
        "resource": "video",
        "operation": "analyze",
        "videoFile": "/data/video.mp4"
      },
      "typeVersion": 1,
      "position": [1400, 200]
    }
  ],
  "connections": {
    "1": { "main": [[{ "node": "Get Channel Uploads", "type": "main", "index": 0 }]] },
    "2": { "main": [[{ "node": "Build Video URL", "type": "main", "index": 0 }]] },
    "2a": { "main": [[{ "node": "Download Video & Write Progress", "type": "main", "index": 0 }]] },
    "2b": { "main": [[{ "node": "Read Download Progress", "type": "main", "index": 0 }]] },
    "3": { "main": [[{ "node": "Log Progress to Google Sheets", "type": "main", "index": 0 }]] },
    "4": { "main": [[{ "node": "Analyze Video with Gemini", "type": "main", "index": 0 }]] }
  }
}
