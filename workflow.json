{
  "name": "YouTube Gaming → Multiple Shorts",
  "nodes": [
    {
      "parameters": {
        "path": "gaming-video",
        "httpMethod": "POST"
      },
      "id": "1",
      "name": "Webhook (Form Input)",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [200, 200]
    },
    {
      "parameters": {
        "command": "yt-dlp -o /tmp/video.mp4 {{$json[\"body\"][\"youtube_url\"]}}"
      },
      "id": "2",
      "name": "Download Video",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [400, 200]
    },
    {
      "parameters": {
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent",
        "method": "POST",
        "authentication": "headerAuth",
        "jsonParameters": true,
        "options": {},
        "body": {
          "contents": [{
            "parts": [{
              "text": "Analyze this gaming video and return JSON with 3-5 highlight clips (≤60s each). Include start_time, end_time, suggested_title, suggested_description. JSON only, no text."
            }]
          }]
        }
      },
      "id": "3",
      "name": "Gemini Highlight Detection",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [600, 200],
      "credentials": {
        "httpHeaderAuth": "Gemini API Key"
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "json",
        "options": {}
      },
      "id": "4",
      "name": "Split Highlights",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 1,
      "position": [800, 200]
    },
    {
      "parameters": {
        "command": "ffmpeg -i /tmp/video.mp4 -ss {{$json[\"start_time\"]}} -to {{$json[\"end_time\"]}} -c copy /tmp/short_{{$json[\"start_time\"]}}.mp4"
      },
      "id": "5",
      "name": "FFmpeg Clip Short",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [1000, 200]
    },
    {
      "parameters": {
        "resource": "video",
        "operation": "upload",
        "title": "{{$json[\"suggested_title\"]}}",
        "description": "{{$json[\"suggested_description\"]}}",
        "additionalFields": {
          "tags": ["gaming", "shorts"],
          "privacyStatus": "public"
        }
      },
      "id": "6",
      "name": "Upload to YouTube Shorts",
      "type": "n8n-nodes-base.youtube",
      "typeVersion": 1,
      "position": [1200, 200],
      "credentials": {
        "youtubeOAuth2Api": "YouTube OAuth"
      }
    },
    {
      "parameters": {
        "operation": "upload",
        "bucketName": "your-gcs-bucket",
        "filePath": "/tmp/short_{{$json[\"start_time\"]}}.mp4"
      },
      "id": "7",
      "name": "Upload to Google Cloud Storage",
      "type": "n8n-nodes-base.googleCloudStorage",
      "typeVersion": 1,
      "position": [1400, 200],
      "credentials": {
        "googleCloudStorageOAuth2Api": "GCS OAuth"
      }
    },
    {
      "parameters": {
        "operation": "append",
        "sheetId": "YOUR_SHEET_ID",
        "range": "Sheet1!A:E",
        "valueInputMode": "RAW",
        "fields": {
          "values": [
            "={{$json[\"original_url\"]}}",
            "={{$json[\"suggested_title\"]}}",
            "={{$json[\"suggested_description\"]}}",
            "={{$json[\"youtube_video_url\"]}}",
            "={{$json[\"gcs_path\"]}}"
          ]
        }
      },
      "id": "8",
      "name": "Log to Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 1,
      "position": [1600, 200],
      "credentials": {
        "googleSheetsOAuth2Api": "Google Sheets OAuth"
      }
    }
  ],
  "connections": {
    "Webhook (Form Input)": { "main": [[{ "node": "Download Video", "type": "main", "index": 0 }]] },
    "Download Video": { "main": [[{ "node": "Gemini Highlight Detection", "type": "main", "index": 0 }]] },
    "Gemini Highlight Detection": { "main": [[{ "node": "Split Highlights", "type": "main", "index": 0 }]] },
    "Split Highlights": { "main": [[{ "node": "FFmpeg Clip Short", "type": "main", "index": 0 }]] },
    "FFmpeg Clip Short": { "main": [[{ "node": "Upload to YouTube Shorts", "type": "main", "index": 0 }]] },
    "Upload to YouTube Shorts": { "main": [[{ "node": "Upload to Google Cloud Storage", "type": "main", "index": 0 }]] },
    "Upload to Google Cloud Storage": { "main": [[{ "node": "Log to Google Sheets", "type": "main", "index": 0 }]] }
  }
}
